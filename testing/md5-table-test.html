<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/png" href="../assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Light Bootstrap Dashboard by Creative Tim</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />


    <!-- Bootstrap core CSS     -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Animation library for notifications   -->
    <link href="../assets/css/animate.min.css" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="../assets/css/light-bootstrap-dashboard.css?v=1.4.0" rel="stylesheet"/>


    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="../assets/css/demo.css" rel="stylesheet" />


    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="../assets/css/pe-icon-7-stroke.css" rel="stylesheet" />


</head>

<body>
    <!--    POP-UP MODAL     -->
    <div class="modal fade" id="insertStudentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="insertStudentLabel">New message</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form>
                <div class="form-group">
                  <label for="student-name" class="col-form-label">Student Name</label>
                  <input type="text" class="form-control" id="student-name">
                </div>
                <div class="form-group">
                    <label for="student-matric" class="col-form-label">Matric Number</label>
                    <input type="text" class="form-control" id="student-matric">
                </div>
                <div class="form-group">
                    <label for="student-mobile" class="col-form-label">Mobile Number</label>
                    <input type="text" class="form-control" id="student-mobile">
                </div>
                <div class="form-group">
                    <label for="student-schedule" class="col-form-label">Working Schedule</label>
                    <input type="text" class="form-control" id="student-schedule" value="eg: Monday, 11-8 PM">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background-color: #6c757d;border-color: #6c757d">Close</button>
              <button type="button" class="btn btn-primary" id="insertStudent-btn" style="background-color: #007bff;border-color: #007bff; color:#ffffff">Send message</button>
            </div>
          </div>
        </div>
    </div>

    <!--    STUDENTS TABLE      -->
    <div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="header">
                        <h4 class="title">Student Assistants 2018</h4>
                        <p class="category">Students who are on duty in i-Hub facility</p>
                    </div>
                    <div class="content table-responsive table-full-width">
                        <div class="button-group">
                                <button type="button" rel="tooltip" title="Edit Task" class="btn btn-info btn-simple btn-lg" id='student-plus-btn'
                                    data-toggle="modal" data-target="#insertStudentModal" data-action="Insert New Student">
                                    <i class="fa fa-plus" style="font-size:24px;color:green;"></i>
                                </button>
                                <button type="button" rel="tooltip" title="refresh" class="btn-simple btn-lg" id='student-refresh-btn' style="background-color: transparent">
                                    <i class="fa fa-refresh" style="font-size:24px;"></i>
                                </button>
                                <button type="button" rel="tooltip" title="Remove" class="btn btn-danger btn-simple btn-lg" id='student-trash-btn'>
                                    <i class="fa fa-trash" style="font-size:24px;color:red;"></i>
                                </button>
                        </div>
                        <table class="table table-hover table-striped students-table">
                            <thead>
                                <th>#</th>
                                <th>Name</th>
                                <th>Matric</th>
                                <th>Mobile</th>
                                <th>Working Schedule</th>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Dakota Rice</td>
                                    <td>U1675389J</td>
                                    <td>97378172</td>
                                    <td>Monday, 8 - 11 AM</td>
                                </tr>
                                <tr>                                        	
                                    <td>2</td>
                                    <td>Minerva Hopper</td>
                                    <td>U1875126J</td>
                                    <td>81238172</td>
                                    <td>Monday, 1 - 5 PM</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Sage Rodriguez</td>
                                    <td>U1726351J</td>
                                    <td>81268372</td>
                                    <td>Tuesday, 8 - 11 AM</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Philip Chaney</td>
                                    <td>U1623187J</td>
                                    <td>98271362</td>
                                    <td>Tuesday, 1 - 5 PM</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>Doris Greene</td>
                                    <td>U1872512J</td>
                                    <td>81726145</td>
                                    <td>Wednesday, 8 - 11 AM</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td>Mason Porter</td>
                                    <td>U1587253J</td>
                                    <td>98716253</td>
                                    <td>Wednesday, 1 - 5 PM</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!--    ATTENDANCE RECORDS TABLE     -->
    <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Attendance Records</h4>
                                <p class="category">Daily records from on-duty student assistants @iHub</p>
                            </div>
                            <div class="content table-responsive table-full-width">
                                <div class="button-group">
                                       
                                </div>
                                <table class="table table-hover table-striped attendance-table" style="text-align: justify;">
                                    <thead id>
                                        <th>#</th>
                                        <th>Name</th>
                                        <th>Matric</th>
                                        <th>Job_ID</th>
                                        <th>Date</th>
                                        <th>Day</th>
                                        <th>Time in</th>
                                        <th>Time out</th>
                                        <th>Remarks</th>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>1</td>
                                            <td>Dakota Rice</td>
                                            <td>U1675389J</td>
                                            <td>X19827</td>
                                            <td>18/12/2018</td>
                                            <td>Wednesday</td>
                                            <td>08:00:01 AM</td>
                                            <td>1:00:00 PM</td>
                                            <td>Substitute</td>
                                        </tr>
                                       
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>

</body>
</html>

<!--   Core JS Files   -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

<!--    Javascript calling BlockSpring API     -->
<script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="https://cdn.blockspring.com/blockspring.js"></script>
<script src="client-test.js"></script>

<!--    Bootstrap Popper & Tooltip -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!--  Charts Plugin -->
<script src="../assets/js/chartist.min.js"></script>

<!--  Notifications Plugin    -->
<script src="../assets/js/bootstrap-notify.js"></script>

<!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="../assets/js/light-bootstrap-dashboard.js?v=1.4.0"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="../assets/js/demo.js"></script>

<!--  JjQuery scripts -->
<script>

// init table contructor
var tableContructor = new TableContructor(7);

// function to construct table from GET result for callbacks  
const constructTable = (table_id, res)=>{
    console.log("Recontructing...\n", res.params.data);
    // reconstruct table
    let resData = res.params.data;
    var $targetHead = $(`table.${table_id} > thead`);
    var $targetBody = $(`table.${table_id} > tbody`);
    // display table content
    var {header, content} = tableContructor.construct(true, resData);
    $targetBody.html(content);
    $targetHead.html(header);
};

// jQuery convention for running when the document has been fully loaded:
$(document).ready(() => {
    loadAttendanceTable();

    // refresh Table button
    $('#student-refresh-btn').click(function(){
        console.log("Refresh clicked...")
        // request GET with query to API
        var resdata = getProfiles(STUDENTS_TABLE.TABLE_NAME, STUDENTS_TABLE.WID[0], constructTable);
    });

    // Modal insert button
    $('#insertStudent-btn').click(function(){
        // TODO: remove hardcoded array with jQuery multi element class selector
        let field_ids = ['#student-name', '#student-matric', '#student-mobile', '#student-schedule'];
        var values = field_ids.map((field_id)=> $(field_id).val());
        // insert new row
        var { _, content:newRow } = tableContructor.construct(false, [values]);
        var $targetSection = $('table.students-table > tbody');
        $targetSection.append(newRow);
        // call Post method to API
        postAttendance([[99, ...values]], STUDENTS_TABLE.TABLE_NAME, STUDENTS_TABLE.WID[0], null);
    });

    // Modals pop-up tuning 
    $('#insertStudentModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        var action = button.data('action') // Extract info from data-* attributes
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text(action)
    });

    // Display Attendance Records Table
    function loadAttendanceTable(){
        console.log("Loading Attendance Records Table...");
        // call GET with query method to API
        var resData = getProfiles(ATTENDANCE_RECORDS.TABLE_NAME, ATTENDANCE_RECORDS.WID[0], constructTable);
        // TODO:
        
    }



}); // jQUery(document).ready()


</script>
